openapi: 3.0.0
paths:
  /metrics:
    get:
      operationId: MetricsController_getMetrics
      parameters: []
      responses:
        "200":
          description: ""
      tags:
        - Metrics
  /v1/ideas:
    get:
      operationId: IdeasController_list
      parameters: []
      responses:
        "200":
          description: ""
      tags: &a1
        - Ideas
    post:
      operationId: IdeasController_create
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateIdeaDto"
      responses:
        "201":
          description: ""
      tags: *a1
  /v1/ideas/{id}:
    get:
      operationId: IdeasController_getById
      parameters:
        - name: id
          required: true
          in: path
          schema:
            type: string
      responses:
        "200":
          description: ""
      tags: *a1
    patch:
      operationId: IdeasController_update
      parameters:
        - name: id
          required: true
          in: path
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateIdeaDto"
      responses:
        "200":
          description: ""
      tags: *a1
    delete:
      operationId: IdeasController_remove
      parameters:
        - name: id
          required: true
          in: path
          schema:
            type: string
      responses:
        "204":
          description: ""
      tags: *a1
  /v1/ideas/{id}/attach-plans:
    post:
      operationId: IdeasController_attachPlans
      parameters:
        - name: id
          required: true
          in: path
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AttachPlansDto"
      responses:
        "201":
          description: ""
      tags: *a1
  /v1/plans:
    get:
      operationId: PlansController_list
      parameters: []
      responses:
        "200":
          description: ""
      tags: &a2
        - Plans
    post:
      operationId: PlansController_create
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePlanDto"
      responses:
        "201":
          description: ""
      tags: *a2
  /v1/plans/{planId}:
    get:
      operationId: PlansController_get
      parameters:
        - name: planId
          required: true
          in: path
          schema:
            type: string
      responses:
        "200":
          description: ""
      tags: *a2
    patch:
      operationId: PlansController_update
      parameters:
        - name: planId
          required: true
          in: path
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdatePlanDto"
      responses:
        "200":
          description: ""
      tags: *a2
    delete:
      operationId: PlansController_remove
      parameters:
        - name: planId
          required: true
          in: path
          schema:
            type: string
      responses:
        "204":
          description: ""
      tags: *a2
  /v1/plans/{planId}/sections:
    get:
      operationId: PlansController_listSections
      parameters:
        - name: planId
          required: true
          in: path
          schema:
            type: string
      responses:
        "200":
          description: ""
      tags: *a2
    post:
      operationId: PlansController_createSection
      parameters:
        - name: planId
          required: true
          in: path
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateSectionDto"
      responses:
        "201":
          description: ""
      tags: *a2
  /v1/plans/{planId}/sections/{sectionId}:
    patch:
      operationId: PlansController_updateSection
      parameters:
        - name: planId
          required: true
          in: path
          schema:
            type: string
        - name: sectionId
          required: true
          in: path
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateSectionDto"
      responses:
        "200":
          description: ""
      tags: *a2
    delete:
      operationId: PlansController_removeSection
      parameters:
        - name: planId
          required: true
          in: path
          schema:
            type: string
        - name: sectionId
          required: true
          in: path
          schema:
            type: string
      responses:
        "204":
          description: ""
      tags: *a2
  /v1/plans/{planId}/sections{reorder}:
    post:
      operationId: PlansController_reorderSections
      parameters:
        - name: planId
          required: true
          in: path
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReorderSectionsDto"
      responses:
        "201":
          description: ""
      tags: *a2
  /v1/plans/{planId}/ideas{attach}:
    post:
      operationId: PlansController_attachIdeas
      parameters:
        - name: planId
          required: true
          in: path
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AttachIdeasDto"
      responses:
        "201":
          description: ""
      tags: *a2
  /v1/ai/generate:
    post:
      operationId: AiController_generate
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GenerateAiDto"
      responses:
        "201":
          description: ""
      tags: &a3
        - Ai
  /v1/ai/plan-chat:
    post:
      operationId: AiController_planChat
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PlanChatDto"
      responses:
        "201":
          description: ""
      tags: *a3
  /v1/ai/nudge:
    post:
      operationId: AiController_nudge
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NudgeDto"
      responses:
        "201":
          description: ""
      tags: *a3
  /v1/ai/plans:
    post:
      operationId: AiController_planAssist
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PlanAssistDto"
      responses:
        "201":
          description: ""
      tags: *a3
  /v1/ai/calendar:
    post:
      operationId: AiController_calendar
      parameters: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CalendarRequestDto"
      responses:
        "200":
          description: Server Sent Events stream with calendar chunks and summary.
          content:
            text/event-stream:
              schema:
                type: string
                example: >
                  event: data
                  data: {"data":{"type":"calendar_piece","runId":"...","calendarId":"...","index":0,"total":3,"piece":{"title":"Publicación 1","channel":"instagram","format":"post","copy":"...","script":"...","targetAudience":"...","date":"2025-11-05","time":"09:00","hashtags":["marketing"]}},"error":null,"meta":{"requestId":"...","provider":"test-provider","chunk":true,"index":0,"total":3}}

                  event: done
                  data: {"data":{"type":"calendar_summary","calendarId":"...","runId":"...","pieceCount":3,"status":"completed","diff":{"added":[{"title":"Publicación 1","channel":"instagram","format":"post","copy":"...","script":"...","targetAudience":"...","date":"2025-11-05","time":"09:00","hashtags":["marketing"]}],"updated":[],"removed":[]}},"error":null,"meta":{"requestId":"...","provider":"test-provider"}}
      tags: *a3
  /healthz:
    get:
      operationId: HealthController_getHealth
      parameters: []
      responses:
        "200":
          description: ""
      tags:
        - Health
info:
  title: IREAL Service API
  description: Versioned API for the decoupled IREAL backend service.
  version: 0.0.1
  contact: {}
tags: []
servers: []
components:
  schemas:
    CreateIdeaDto:
      type: object
      properties: {}
    UpdateIdeaDto:
      type: object
      properties: {}
    AttachPlansDto:
      type: object
      properties: {}
    CreatePlanDto:
      type: object
      properties: {}
    UpdatePlanDto:
      type: object
      properties: {}
    CreateSectionDto:
      type: object
      properties: {}
    UpdateSectionDto:
      type: object
      properties: {}
    ReorderSectionsDto:
      type: object
      properties: {}
    AttachIdeasDto:
      type: object
      properties: {}
    GenerateAiDto:
      type: object
      properties: {}
    PlanChatDto:
      type: object
      properties: {}
    NudgeDto:
      type: object
      properties: {}
    PlanAssistDto:
      type: object
      properties: {}
    CalendarRequestDto:
      type: object
      required:
        - channels
        - cadence
        - start
        - end
      properties:
        channels:
          type: array
          description: Content channels to populate during generation.
          items:
            type: string
        cadence:
          type: string
          enum:
            - daily
            - weekly
            - monthly
        start:
          type: string
          format: date-time
          description: ISO8601 start date for the calendar window.
        end:
          type: string
          format: date-time
          description: ISO8601 end date for the calendar window.
        constraints:
          type: object
          additionalProperties: true
          description: Arbitrary constraints or guidance to influence the schedule.
        calendarId:
          type: string
          format: uuid
          description: Existing calendar identifier to diff against on regeneration.
        planId:
          type: string
          format: uuid
          description: Optional plan identifier associated with this calendar run.
        timezone:
          type: string
        objectives:
          type: string
        ideas:
          type: string
        pillars:
          type: string
        accounts:
          type: array
          items:
            type: string
    CalendarPiece:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        channel:
          type: string
        format:
          type: string
        copy:
          type: string
        script:
          type: string
        targetAudience:
          type: string
        date:
          type: string
          format: date
        time:
          type: string
        hashtags:
          type: array
          items:
            type: string
    CalendarDiff:
      type: object
      properties:
        added:
          type: array
          items:
            $ref: "#/components/schemas/CalendarPiece"
        updated:
          type: array
          items:
            type: object
            properties:
              before:
                $ref: "#/components/schemas/CalendarPiece"
              after:
                $ref: "#/components/schemas/CalendarPiece"
        removed:
          type: array
          items:
            $ref: "#/components/schemas/CalendarPiece"
    CalendarSummaryEvent:
      type: object
      properties:
        type:
          type: string
          example: calendar_summary
        calendarId:
          type: string
          format: uuid
        runId:
          type: string
          format: uuid
        pieceCount:
          type: integer
        status:
          type: string
          enum:
            - completed
            - timeout
            - failed
        diff:
          $ref: "#/components/schemas/CalendarDiff"
